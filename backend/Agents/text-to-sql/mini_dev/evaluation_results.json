{
  "total": 10,
  "correct": 4,
  "execution_errors": 1,
  "wrong_results": 5,
  "examples": [
    {
      "id": 0,
      "question": "What is the ratio of customers who pay in EUR against customers who pay in CZK?",
      "status": "correct"
    },
    {
      "id": 1,
      "question": "In 2012, who had the least consumption in LAM?",
      "predicted_sql": "SELECT CustomerID, MIN(TotalConsumption) AS LeastConsumption\nFROM (\n    SELECT CustomerID, SUM(Consumption) AS TotalConsumption\n    FROM yearmonth\n    WHERE SUBSTR(Date, 1, 4) = '2012'\n    GROUP BY CustomerID\n) AS Consumption2012\nJOIN customers ON Consumption2012.CustomerID = customers.CustomerID\nWHERE customers.Segment = 'LAM'\nORDER BY LeastConsumption\nLIMIT 1;",
      "error": "ambiguous column name: CustomerID",
      "status": "execution_error"
    },
    {
      "id": 2,
      "question": "What was the average monthly consumption of customers in SME for the year 2013?",
      "status": "correct"
    },
    {
      "id": 3,
      "question": "What was the difference in gas consumption between CZK-paying customers and EUR-paying customers in 2012?",
      "status": "correct"
    },
    {
      "id": 4,
      "question": "Which year recorded the most consumption of gas paid in CZK?",
      "predicted_sql": "SELECT SUBSTR(Date, 1, 4) AS Year, SUM(Consumption) AS TotalConsumption\nFROM yearmonth\nJOIN customers ON yearmonth.CustomerID = customers.CustomerID\nWHERE customers.Currency = 'CZK'\nGROUP BY Year\nORDER BY TotalConsumption DESC\nLIMIT 1;",
      "ground_truth_sql": "SELECT SUBSTR(T2.Date, 1, 4) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' GROUP BY SUBSTR(T2.Date, 1, 4) ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
      "predicted_result": [
        [
          "2013",
          2992757755.72
        ]
      ],
      "ground_truth_result": [
        [
          "2013"
        ]
      ],
      "status": "wrong_result"
    },
    {
      "id": 5,
      "question": "What was the gas consumption peak month for SME customers in 2013?",
      "predicted_sql": "SELECT SUBSTR(Date, 1, 6) AS YearMonth, SUM(Consumption) AS TotalConsumption\nFROM yearmonth\nJOIN customers ON yearmonth.CustomerID = customers.CustomerID\nWHERE customers.Segment = 'SME' AND SUBSTR(Date, 1, 4) = '2013'\nGROUP BY YearMonth\nORDER BY TotalConsumption DESC\nLIMIT 1;",
      "ground_truth_sql": "SELECT SUBSTR(T2.Date, 5, 2) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE SUBSTR(T2.Date, 1, 4) = '2013' AND T1.Segment = 'SME' GROUP BY SUBSTR(T2.Date, 5, 2) ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
      "predicted_result": [
        [
          "201304",
          126047776.92
        ]
      ],
      "ground_truth_result": [
        [
          "04"
        ]
      ],
      "status": "wrong_result"
    },
    {
      "id": 6,
      "question": "What is the difference in the annual average consumption of the customers with the least amount of consumption paid in CZK for 2013 between SME and LAM, LAM and KAM, and KAM and SME?",
      "predicted_sql": "WITH MinConsumption AS (\n    SELECT Segment, MIN(Consumption) AS MinCons\n    FROM customers\n    JOIN yearmonth ON customers.CustomerID = yearmonth.CustomerID\n    WHERE Currency = 'CZK' AND SUBSTR(Date, 1, 4) = '2013'\n    GROUP BY Segment\n),\nAnnualAverage AS (\n    SELECT Segment, SUM(Consumption) / COUNT(DISTINCT yearmonth.CustomerID) AS AnnualAvg\n    FROM customers\n    JOIN yearmonth ON customers.CustomerID = yearmonth.CustomerID\n    WHERE Currency = 'CZK' AND SUBSTR(Date, 1, 4) = '2013'\n    AND Consumption IN (SELECT MinCons FROM MinConsumption WHERE MinConsumption.Segment = customers.Segment)\n    GROUP BY Segment\n)\nSELECT \n    (SELECT AnnualAvg FROM AnnualAverage WHERE Segment = 'SME') - \n    (SELECT AnnualAvg FROM AnnualAverage WHERE Segment = 'LAM') AS SME_LAM_Diff,\n    (SELECT AnnualAvg FROM AnnualAverage WHERE Segment = 'LAM') - \n    (SELECT AnnualAvg FROM AnnualAverage WHERE Segment = 'KAM') AS LAM_KAM_Diff,\n    (SELECT AnnualAvg FROM AnnualAverage WHERE Segment = 'KAM') - \n    (SELECT AnnualAvg FROM AnnualAverage WHERE Segment = 'SME') AS KAM_SME_Diff;",
      "ground_truth_sql": "SELECT CAST(SUM(IIF(T1.Segment = 'SME', T2.Consumption, 0)) AS REAL) / COUNT(T1.CustomerID) - CAST(SUM(IIF(T1.Segment = 'LAM', T2.Consumption, 0)) AS REAL) / COUNT(T1.CustomerID) , CAST(SUM(IIF(T1.Segment = 'LAM', T2.Consumption, 0)) AS REAL) / COUNT(T1.CustomerID) - CAST(SUM(IIF(T1.Segment = 'KAM', T2.Consumption, 0)) AS REAL) / COUNT(T1.CustomerID) , CAST(SUM(IIF(T1.Segment = 'KAM', T2.Consumption, 0)) AS REAL) / COUNT(T1.CustomerID) - CAST(SUM(IIF(T1.Segment = 'SME', T2.Consumption, 0)) AS REAL) / COUNT(T1.CustomerID) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Consumption = ( SELECT MIN(Consumption) FROM yearmonth ) AND T2.Date BETWEEN 201301 AND 201312",
      "predicted_result": [
        [
          -12438.07,
          579634.8099999999,
          -567196.74
        ]
      ],
      "ground_truth_result": [
        [
          0.0,
          582092.86,
          -582092.86
        ]
      ],
      "status": "wrong_result"
    },
    {
      "id": 7,
      "question": "Which of the three segments—SME, LAM and KAM—has the biggest and lowest percentage increases in consumption paid in EUR between 2012 and 2013?",
      "predicted_sql": "WITH yearly_consumption AS (\n    SELECT \n        c.Segment,\n        SUBSTR(y.Date, 1, 4) AS Year,\n        SUM(y.Consumption) AS TotalConsumption\n    FROM \n        yearmonth y\n    JOIN \n        customers c ON y.CustomerID = c.CustomerID\n    WHERE \n        c.Currency = 'EUR' AND (SUBSTR(y.Date, 1, 4) = '2012' OR SUBSTR(y.Date, 1, 4) = '2013')\n    GROUP BY \n        c.Segment, SUBSTR(y.Date, 1, 4)\n),\nconsumption_change AS (\n    SELECT \n        yc2013.Segment,\n        (yc2013.TotalConsumption - yc2012.TotalConsumption) AS ConsumptionIncrease,\n        ((yc2013.TotalConsumption - yc2012.TotalConsumption) / yc2013.TotalConsumption) * 100.0 AS PercentageIncrease\n    FROM \n        yearly_consumption yc2012\n    JOIN \n        yearly_consumption yc2013 ON yc2012.Segment = yc2013.Segment AND yc2012.Year = '2012' AND yc2013.Year = '2013'\n)\nSELECT \n    Segment,\n    MAX(PercentageIncrease) AS MaxPercentageIncrease,\n    MIN(PercentageIncrease) AS MinPercentageIncrease\nFROM \n    consumption_change;",
      "ground_truth_sql": "SELECT CAST((SUM(IIF(T1.Segment = 'SME' AND T2.Date LIKE '2013%', T2.Consumption, 0)) - SUM(IIF(T1.Segment = 'SME' AND T2.Date LIKE '2012%', T2.Consumption, 0))) AS FLOAT) * 100 / SUM(IIF(T1.Segment = 'SME' AND T2.Date LIKE '2012%', T2.Consumption, 0)), CAST(SUM(IIF(T1.Segment = 'LAM' AND T2.Date LIKE '2013%', T2.Consumption, 0)) - SUM(IIF(T1.Segment = 'LAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) AS FLOAT) * 100 / SUM(IIF(T1.Segment = 'LAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) , CAST(SUM(IIF(T1.Segment = 'KAM' AND T2.Date LIKE '2013%', T2.Consumption, 0)) - SUM(IIF(T1.Segment = 'KAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) AS FLOAT) * 100 / SUM(IIF(T1.Segment = 'KAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID",
      "predicted_result": [
        [
          "LAM",
          88.01984961472203,
          84.37082878168066
        ]
      ],
      "ground_truth_result": [
        [
          545.4018999790969,
          681.5824574939339,
          708.1124062978664
        ]
      ],
      "status": "wrong_result"
    },
    {
      "id": 8,
      "question": "How much did customer 6 consume in total between August and November 2013?",
      "status": "correct"
    },
    {
      "id": 9,
      "question": "How many more \"discount\" gas stations does the Czech Republic have compared to Slovakia?",
      "predicted_sql": "SELECT \n    (SELECT COUNT(*) \n     FROM gasstations \n     WHERE Country = 'CZE' AND Segment = 'discount') -\n    (SELECT COUNT(*) \n     FROM gasstations \n     WHERE Country = 'SVK' AND Segment = 'discount') AS Difference\n;",
      "ground_truth_sql": "SELECT SUM(IIF(Country = 'CZE', 1, 0)) - SUM(IIF(Country = 'SVK', 1, 0)) FROM gasstations WHERE Segment = 'Discount'",
      "predicted_result": [
        [
          0
        ]
      ],
      "ground_truth_result": [
        [
          176
        ]
      ],
      "status": "wrong_result"
    }
  ]
}